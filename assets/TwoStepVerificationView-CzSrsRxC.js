import{d as y,a as h,r as u,c as R,b as p,f as a,e as k,F as B,g as d,h as C,i as b,u as P,s as O}from"./index-CqF_l6GU.js";import{a as L}from"./function-call-CJ1tGEqk.js";const N="/yrs/assets/two-step-verification-DoUJR3r-.png",j=y("twoStepVerificationStore",{state:()=>({response:null,error:null,errorMessage:null,errors:[]}),getters:{getResponse:s=>s.response,getError:s=>s.error,getErrorMessage:s=>s.errorMessage,getErrors:s=>s.errors},actions:{async store(s,i){var o,n,l,t;try{let r=await h.post("user-portal/two-step-verification",{otp_token:s,code:i});this.response=r.data??null,this.error=null,this.errorMessage=null,this.errors=[]}catch(r){this.response=null,this.error=r,this.errorMessage=((n=(o=r==null?void 0:r.response)==null?void 0:o.data)==null?void 0:n.message)??null,this.errors=((t=(l=r==null?void 0:r.response)==null?void 0:l.data)==null?void 0:t.errors)??null}}}}),F=y("resendOTPStore",{state:()=>({response:null,error:null,errorMessage:null,errors:[]}),getters:{getResponse:s=>s.response,getError:s=>s.error,getErrorMessage:s=>s.errorMessage,getErrors:s=>s.errors},actions:{async store(s){var i,o,n,l;try{let t=await h.post("user-portal/resend-otp",{otp_token:s});this.response=t.data??null,this.error=null,this.errorMessage=null,this.errors=[]}catch(t){this.response=null,this.error=t,this.errorMessage=((o=(i=t==null?void 0:t.response)==null?void 0:i.data)==null?void 0:o.message)??null,this.errors=((l=(n=t==null?void 0:t.response)==null?void 0:n.data)==null?void 0:l.errors)??null}}}}),U={class:"p-3"},$={class:"bg-white rounded-lg"},z={class:"pb-3"},D={class:"text-center pb-3"},I={class:"my-4"},q={__name:"TwoStepVerificationView",setup(s){const i=P(),o=j(),n=F(),l=u(ls.get("__otp-token")),t=u(""),r=u({otp_token:"",code:""}),f=u(!1),_=u(!1),c=u(!0),S=()=>history.back(),x=async g=>{var e,v;f.value=!0,r.value={otp_token:"",code:""},await o.store(l.value,t.value),o.getErrorMessage?o.getErrors&&(r.value={otp_token:o.getErrors.otp_token?o.getErrors.otp_token.join(", "):"",code:o.getErrors.code?o.getErrors.code.join(", "):""}):(ls.set("__access-token",(e=o.getResponse)==null?void 0:e.data.access_token),ls.remove("__otp-token"),L((v=o.getResponse)==null?void 0:v.message),i.push("profile")),f.value=!1},E=async()=>{var g,e;_.value=!0,await n.store(l.value),n.getErrorMessage==null&&(ls.set("__otp-token",(g=n.getResponse)==null?void 0:g.data.otp_token),O({type:"success",message:(e=n.getResponse)==null?void 0:e.message,position:"bottom"})),_.value=!1};return(g,e)=>{const v=d("van-nav-bar"),M=d("van-password-input"),T=d("van-number-keyboard"),w=d("van-button"),V=d("van-form");return C(),R(B,null,[p(v,{title:"Two Step Verification",fixed:!0,"left-text":"","left-arrow":"",onClickLeft:S}),e[7]||(e[7]=a("div",{class:"pt-[46px]"},null,-1)),a("div",U,[p(V,{onSubmit:x},{default:k(()=>[a("div",$,[e[4]||(e[4]=a("div",{class:"flex justify-center items-center py-3"},[a("img",{src:N,alt:"",class:"w-5/12"})],-1)),e[5]||(e[5]=a("div",{class:"mb-3"},[a("p",{class:"text-center text-gray-500 text-sm"}," Please enter the OTP in the field below to verify. ")],-1)),a("div",z,[p(M,{value:t.value,mask:!1,"error-info":r.value.code,focused:c.value,onFocus:e[0]||(e[0]=m=>c.value=!0)},null,8,["value","error-info","focused"]),p(T,{modelValue:t.value,"onUpdate:modelValue":e[1]||(e[1]=m=>t.value=m),show:c.value,onBlur:e[2]||(e[2]=m=>c.value=!1)},null,8,["modelValue","show"])]),a("div",D,[p(w,{type:"default",plain:"",size:"small",loading:_.value,"loading-text":"Loading...",onClick:E},{default:k(()=>e[3]||(e[3]=[b("Resend OTP")])),_:1},8,["loading"])])]),a("div",I,[p(w,{round:"",block:"",type:"primary","native-type":"submit",color:"#1CBC9B",loading:f.value},{default:k(()=>e[6]||(e[6]=[b(" Confirm ")])),_:1},8,["loading"])])]),_:1})])],64)}}};export{q as default};
