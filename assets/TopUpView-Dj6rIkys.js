import{d as w,a as C,r as c,c as U,b as a,f as l,e as f,F as B,g as i,h as M,i as S,u as k}from"./index-CqF_l6GU.js";import{a as T}from"./function-call-CJ1tGEqk.js";const j="/yrs/assets/top-up-BYFYM6Nr.png",F=w("topUpStore",{state:()=>({response:null,error:null,errorMessage:null,errors:[]}),getters:{getResponse:r=>r.response,getError:r=>r.error,getErrorMessage:r=>r.errorMessage,getErrors:r=>r.errors},actions:{async store(r,_,t){var u,p,m,s;try{let e=new FormData;e.append("amount",r),e.append("description",_),t.length>0&&e.append("image",t[0].file);let b=await C.post("user-portal/top-up",e,{headers:{"Content-Type":"multipart/form-data"}});this.response=b.data??null,this.error=null,this.errorMessage=null,this.errors=[]}catch(e){this.response=null,this.error=e,this.errorMessage=((p=(u=e==null?void 0:e.response)==null?void 0:u.data)==null?void 0:p.message)??null,this.errors=((s=(m=e==null?void 0:e.response)==null?void 0:m.data)==null?void 0:s.errors)??null}}}}),N={class:"p-3"},R={class:"bg-white rounded-lg"},D={class:"my-4"},Y={__name:"TopUpView",setup(r){const _=k(),t=F(),u=c(""),p=c(""),m=c([]),s=c({amount:"",description:"",image:""}),e=c(!1),b=()=>history.back(),y=async g=>{var o,v,n;e.value=!0,s.value={amount:"",description:"",image:""},await t.store(g.amount,g.description,g.image),t.getErrorMessage?t.getErrors&&(s.value={amount:t.getErrors.amount?t.getErrors.amount.join(", "):"",description:t.getErrors.description?t.getErrors.description.join(", "):"",image:t.getErrors.image?t.getErrors.image.join(", "):""}):(T((o=t.getResponse)==null?void 0:o.message),_.push(`top-up-history/${(n=(v=t.getResponse)==null?void 0:v.data)==null?void 0:n.trx_id}`)),e.value=!1};return(g,o)=>{const v=i("van-nav-bar"),n=i("van-field"),E=i("van-uploader"),V=i("van-cell-group"),h=i("van-button"),x=i("van-form");return M(),U(B,null,[a(v,{title:"Top Up",fixed:!0,"left-text":"","left-arrow":"",onClickLeft:b}),o[5]||(o[5]=l("div",{class:"pt-[46px]"},null,-1)),l("div",N,[a(x,{onSubmit:y},{default:f(()=>[l("div",R,[o[3]||(o[3]=l("div",{class:"flex justify-center items-center py-3"},[l("img",{src:j,alt:"",class:"w-5/12"})],-1)),a(V,{inset:"",class:"mb-3 mx-0"},{default:f(()=>[a(n,{modelValue:u.value,"onUpdate:modelValue":o[0]||(o[0]=d=>u.value=d),name:"amount",label:"Amount",placeholder:"Enter your amount","error-message":s.value.amount},null,8,["modelValue","error-message"]),a(n,{modelValue:p.value,"onUpdate:modelValue":o[1]||(o[1]=d=>p.value=d),name:"description",label:"Description",placeholder:"Enter your description","error-message":s.value.description},null,8,["modelValue","error-message"]),a(n,{name:"image",label:"Image","error-message":s.value.image},{input:f(()=>[a(E,{modelValue:m.value,"onUpdate:modelValue":o[2]||(o[2]=d=>m.value=d),"max-count":"1"},null,8,["modelValue"])]),_:1},8,["error-message"])]),_:1})]),l("div",D,[a(h,{round:"",block:"",type:"primary","native-type":"submit",color:"#1CBC9B",loading:e.value},{default:f(()=>o[4]||(o[4]=[S(" Confirm ")])),_:1},8,["loading"])])]),_:1})])],64)}}};export{Y as default};
