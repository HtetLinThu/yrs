import{d as h,a as R,r as _,c as C,b as r,f as n,e as p,i as v,F as L,g as l,h as S,u as B}from"./index-CqF_l6GU.js";import{a as M}from"./function-call-CJ1tGEqk.js";const N="/yrs/assets/login-CHY2PuP-.png",j=h("loginStore",{state:()=>({response:null,error:null,errorMessage:null,errors:[]}),getters:{getResponse:t=>t.response,getError:t=>t.error,getErrorMessage:t=>t.errorMessage,getErrors:t=>t.errors},actions:{async store(t,m){var s,i,d,a;try{let o=await R.post("user-portal/login",{email:t,password:m});this.response=o.data??null,this.error=null,this.errorMessage=null,this.errors=[]}catch(o){this.response=null,this.error=o,this.errorMessage=((i=(s=o==null?void 0:o.response)==null?void 0:s.data)==null?void 0:i.message)??null,this.errors=((a=(d=o==null?void 0:o.response)==null?void 0:d.data)==null?void 0:a.errors)??null}}}}),P={class:"p-3"},F={class:"bg-white rounded-lg"},T={class:"my-4"},U={class:"text-center text-sm"},O={__name:"LoginView",setup(t){const m=B(),s=j(),i=_(""),d=_(""),a=_({email:"",password:""}),o=_(!1),b=()=>history.back(),y=async f=>{var e,g,u,c;o.value=!0,a.value={email:"",password:""},await s.store(f.email,f.password),s.getErrorMessage?s.getErrors&&(a.value={email:s.getErrors.email?s.getErrors.email.join(", "):"",password:s.getErrors.password?s.getErrors.password.join(", "):""}):(e=s.getResponse)!=null&&e.data.is_verified?(ls.set("__access-token",(g=s.getResponse)==null?void 0:g.data.access_token),M((u=s.getResponse)==null?void 0:u.message),m.push("profile")):(ls.set("__otp-token",(c=s.getResponse)==null?void 0:c.data.otp_token),m.push("two-step-verification")),o.value=!1};return(f,e)=>{const g=l("van-nav-bar"),u=l("van-field"),c=l("van-cell-group"),x=l("van-button"),E=l("van-form"),k=l("van-divider"),V=l("RouterLink");return S(),C(L,null,[r(g,{title:"Login",fixed:!0,"left-text":"","left-arrow":"",onClickLeft:b}),e[7]||(e[7]=n("div",{class:"pt-[46px]"},null,-1)),n("div",P,[r(E,{onSubmit:y},{default:p(()=>[n("div",F,[e[2]||(e[2]=n("div",{class:"flex justify-center items-center py-3"},[n("img",{src:N,alt:"",class:"w-5/12"})],-1)),r(c,{inset:"",class:"mb-3 mx-0"},{default:p(()=>[r(u,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=w=>i.value=w),name:"email",label:"Email",placeholder:"Enter your email","error-message":a.value.email},null,8,["modelValue","error-message"]),r(u,{modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=w=>d.value=w),type:"password",name:"password",label:"Password",placeholder:"Enter your password","error-message":a.value.password},null,8,["modelValue","error-message"])]),_:1})]),n("div",T,[r(x,{round:"",block:"",type:"primary","native-type":"submit",color:"#1CBC9B",loading:o.value},{default:p(()=>e[3]||(e[3]=[v(" Confirm ")])),_:1},8,["loading"])])]),_:1}),r(k,{class:"border-theme"},{default:p(()=>e[4]||(e[4]=[v("Or")])),_:1}),n("p",U,[e[6]||(e[6]=v(" Not registered? ")),r(V,{to:"/register",class:"text-theme"},{default:p(()=>e[5]||(e[5]=[v("Register")])),_:1})])])],64)}}};export{O as default};
