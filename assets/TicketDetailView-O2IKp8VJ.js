import{d as b,a as M,r as d,o as N,c as h,b as r,e as v,F as B,g as i,h as f,f as c,i as P,D as y,t as x,m as R,u as $,k as z}from"./index-CqF_l6GU.js";import{a as F}from"./function-call-CJ1tGEqk.js";const j=b("ticketDetailStore",{state:()=>({response:null,error:null,errorMessage:null,errors:[]}),getters:{getResponse:t=>t.response,getError:t=>t.error,getErrorMessage:t=>t.errorMessage,getErrors:t=>t.errors},actions:{async get(t){var o,l,a,s;try{let e=await M.get(`user-portal/ticket/${t}`);this.response=e.data??null,this.error=null,this.errorMessage=null,this.errors=[]}catch(e){this.response=null,this.error=e,this.errorMessage=((l=(o=e==null?void 0:e.response)==null?void 0:o.data)==null?void 0:l.message)??null,this.errors=((s=(a=e==null?void 0:e.response)==null?void 0:a.data)==null?void 0:s.errors)??null}}}}),I=b("regenerateQRStore",{state:()=>({response:null,error:null,errorMessage:null,errors:[]}),getters:{getResponse:t=>t.response,getError:t=>t.error,getErrorMessage:t=>t.errorMessage,getErrors:t=>t.errors},actions:{async store(t){var o,l,a,s;try{let e=await M.post("user-portal/regenerate-qr",{qr_token:t});this.response=e.data??null,this.error=null,this.errorMessage=null,this.errors=[]}catch(e){this.response=null,this.error=e,this.errorMessage=((l=(o=e==null?void 0:e.response)==null?void 0:o.data)==null?void 0:l.message)??null,this.errors=((s=(a=e==null?void 0:e.response)==null?void 0:a.data)==null?void 0:s.errors)??null}}}}),U={key:0},A={class:"bg-theme pt-14 pb-20"},G={class:"text-center"},H={class:"p-3 relative",style:{top:"-74px"}},J={key:1,class:"pt-14 px-3 pb-20"},K={class:"bg-white rounded-lg shadow-md flex justify-center items-center"},X={__name:"TicketDetailView",setup(t){$();const o=z(),l=j(),a=I(),s=d(null),e=d(null),_=d(!1),g=d(null),m=d(!1),w=()=>history.back(),k=async()=>{var p;await l.get(o.params.ticket_number),s.value=(p=l.getResponse)==null?void 0:p.data,e.value=l.getErrorMessage,_.value=!1,g.value=s.value.qr_token},S=async()=>{var p,n;m.value=!0,await a.store(g.value),a.getErrorMessage==null&&(g.value=(p=a.getResponse)==null?void 0:p.data.qr_token,F((n=a.getResponse)==null?void 0:n.message)),m.value=!1},D=()=>{k()};return N(()=>{k()}),(p,n)=>{const E=i("van-nav-bar"),V=i("vue-qrcode"),T=i("van-button"),u=i("van-cell"),q=i("van-cell-group"),C=i("van-empty"),Q=i("van-pull-refresh");return f(),h(B,null,[r(E,{title:"Ticket Detail",fixed:!0,"left-text":"","left-arrow":"",onClickLeft:w}),r(Q,{modelValue:_.value,"onUpdate:modelValue":n[0]||(n[0]=L=>_.value=L),"pulling-text":"Pull to refresh","loosing-text":"Pull to refresh","loading-text":"Loading","success-text":"Successfully loaded",onRefresh:D},{default:v(()=>[s.value!=null?(f(),h("div",U,[c("div",A,[r(V,{value:g.value,class:"w-20 h-20 bg-gray-100 rounded-lg mx-auto mb-3"},null,8,["value"]),c("div",G,[r(T,{type:"default",plain:"",size:"mini",icon:"replay",class:"rounded-lg border-none","loading-text":"Loading...",loading:m.value,onClick:S},{default:v(()=>n[1]||(n[1]=[P("Regenerate QR")])),_:1},8,["loading"])])]),c("div",H,[r(q,{inset:"",class:"mx-0 mb-3"},{default:v(()=>[r(u,{title:"Ticket Number",value:s.value.ticket_number},null,8,["value"]),r(u,{title:"Type"},{value:v(()=>[c("span",{style:y(`color: #${s.value.type.color}`)},x(s.value.type.text),5)]),_:1}),r(u,{title:"Direction"},{value:v(()=>[c("span",{style:y(`color: #${s.value.direction.color}`)},x(s.value.direction.text),5)]),_:1}),r(u,{title:"Price",value:s.value.price},null,8,["value"]),r(u,{title:"Created at",value:s.value.created_at},null,8,["value"]),r(u,{title:"Valid at",value:s.value.valid_at},null,8,["value"]),r(u,{title:"Expire at",value:s.value.expire_at},null,8,["value"])]),_:1})])])):R("",!0),e.value!=null?(f(),h("div",J,[c("div",K,[c("div",null,[r(C,{image:"error",description:e.value,class:"text-center"},null,8,["description"])])])])):R("",!0)]),_:1},8,["modelValue"])],64)}}};export{X as default};
