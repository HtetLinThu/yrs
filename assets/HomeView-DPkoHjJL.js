import{d as j,a as G,r as l,w as D,o as H,c as Q,b as c,e as S,f as n,F as Z,g as h,h as q,_ as J,t as K,i as X,u as ee}from"./index-CqF_l6GU.js";import{_ as te}from"./station-BqDwrWZh.js";import{u as oe}from"./stationStore-Do9-x91A.js";const ne=j("markerStore",{state:()=>({response:null,error:null,errorMessage:null,errors:[]}),getters:{getResponse:i=>i.response,getError:i=>i.error,getErrorMessage:i=>i.errorMessage,getErrors:i=>i.errors},actions:{async get(i,k,_,y){var u,f,x,w;try{let s=await G.get(`station-by-region?north_east_latitude=${i}&north_east_longitude=${k}&south_west_latitude=${_}&south_west_longitude=${y}`);this.response=s.data??null,this.error=null,this.errorMessage=null,this.errors=[]}catch(s){this.response=null,this.error=s,this.errorMessage=((f=(u=s==null?void 0:s.response)==null?void 0:u.data)==null?void 0:f.message)??null,this.errors=((w=(x=s==null?void 0:s.response)==null?void 0:x.data)==null?void 0:w.errors)??null}}}}),le={class:"p-3 relative",style:{top:"-56px"}},se={class:"origin-component"},ae={class:"destination-component mb-3"},ie={class:"p-3"},ue={class:"text-gray-700 text-md text-center mb-3"},re={class:"text-center"},ge={__name:"HomeView",setup(i){const k=ee(),_=oe(),y=ne(),u=l([]),f=l(1),x=l(null),w=l(!1),s=l([]),g=l(null),V=l(""),b=l(!1),m=l(null),$=l(""),C=l(!1),M=l(!1),p=l(null);var r=null;const B=async()=>{var o,e,t;w.value==!1&&(await _.get({page:f.value,search:""}),u.value.push(...((o=_.getResponse)==null?void 0:o.data)??[]),x.value=((t=(e=_.getResponse)==null?void 0:e.meta)==null?void 0:t.last_page)??null,f.value>=x.value?w.value=!0:f.value++)},R=async()=>{var e;if(r.getZoom()>=13){let t=r.getBounds();await y.get(t._northEast.lat,t._northEast.lng,t._southWest.lat,t._southWest.lng),s.value=((e=y.getResponse)==null?void 0:e.data)??[];var o=L.icon({iconUrl:new URL("/yrs/assets/station-marker-61QbrTf-.png",import.meta.url).href,iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]});s.value.forEach(function(d){L.marker([d.latitude,d.longitude],{icon:o}).addTo(r).on("click",()=>{M.value=!0,p.value=d})})}},E=()=>{b.value=!0,B()},P=({selectedOptions:o})=>{var e,t;g.value=(e=o[0])==null?void 0:e.slug,V.value=(t=o[0])==null?void 0:t.title,b.value=!1},I=({selectedValues:o,selectedOptions:e,selectedIndexes:t,columnIndex:d})=>{var v;((v=u.value[u.value.length-1])==null?void 0:v.slug)==e[0].slug&&B()},T=()=>{C.value=!0,B()},z=({selectedOptions:o})=>{var e,t;m.value=(e=o[0])==null?void 0:e.slug,$.value=(t=o[0])==null?void 0:t.title,C.value=!1},F=({selectedValues:o,selectedOptions:e,selectedIndexes:t,columnIndex:d})=>{var v;((v=u.value[u.value.length-1])==null?void 0:v.slug)==e[0].slug&&B()},N=()=>{g.value=p.value.slug,V.value=p.value.title},O=()=>{m.value=p.value.slug,$.value=p.value.title},A=()=>{r!==null&&r.remove(),r=L.map("map").setView([16.781076,96.161943],13),L.tileLayer("https://api.maptiler.com/maps/streets-v2/{z}/{x}/{y}.png?key=lGRhuk24oNhhSOVUzxcs").addTo(r),navigator.geolocation.getCurrentPosition(o=>{r.setView([o.coords.latitude,o.coords.longitude],13),R(),r.on("moveend",()=>{R()})})};return D(g,()=>{g.value!=null&&m.value!=null&&k.push(`route?origin_station_slug=${g.value}&destination_station_slug=${m.value}`)}),D(m,()=>{g.value!=null&&m.value!=null&&k.push(`route?origin_station_slug=${g.value}&destination_station_slug=${m.value}`)}),H(()=>{A()}),(o,e)=>{const t=h("van-nav-bar"),d=h("van-field"),v=h("van-picker"),U=h("van-popup"),W=h("van-button"),Y=h("van-dialog");return q(),Q(Z,null,[c(t,{fixed:!0},{left:S(()=>e[7]||(e[7]=[n("div",{class:"flex justify-start"},[n("img",{src:J,alt:"",class:"w-8 h-8 rounded-lg bg-white p-1 mr-1"}),n("div",null,[n("h5",{class:"text-left text-white text-xs mb-0"},"YRS"),n("p",{class:"text-left text-white text-xs mb-0"}," Yangon Railway Service ")])],-1)])),_:1}),e[11]||(e[11]=n("div",{class:"bg-theme pt-14 px-3 pb-12"},null,-1)),n("div",le,[n("div",se,[c(d,{modelValue:V.value,"onUpdate:modelValue":e[0]||(e[0]=a=>V.value=a),"is-link":"",readonly:"",label:"Origin",placeholder:"Select Origin",onClick:E},null,8,["modelValue"]),c(U,{show:b.value,"onUpdate:show":e[2]||(e[2]=a=>b.value=a),position:"bottom"},{default:S(()=>[c(v,{title:"Station","confirm-button-text":"Confirm","cancel-button-text":"Cancel",columns:u.value,"columns-field-names":{value:"slug",text:"title"},onConfirm:P,onCancel:e[1]||(e[1]=a=>b.value=!1),onChange:I},null,8,["columns"])]),_:1},8,["show"])]),n("div",ae,[c(d,{modelValue:$.value,"onUpdate:modelValue":e[3]||(e[3]=a=>$.value=a),"is-link":"",readonly:"",label:"Destination",placeholder:"Select Destination",onClick:T},null,8,["modelValue"]),c(U,{show:C.value,"onUpdate:show":e[5]||(e[5]=a=>C.value=a),position:"bottom"},{default:S(()=>[c(v,{title:"Station","confirm-button-text":"Confirm","cancel-button-text":"Cancel",columns:u.value,"columns-field-names":{value:"slug",text:"title"},onConfirm:z,onCancel:e[4]||(e[4]=a=>C.value=!1),onChange:F},null,8,["columns"])]),_:1},8,["show"])]),e[8]||(e[8]=n("div",{class:"h-screen"},[n("div",{id:"map",class:"h-3/6 rounded-lg shadow-md",style:{"z-index":"0"}})],-1))]),c(Y,{show:M.value,"onUpdate:show":e[6]||(e[6]=a=>M.value=a),"close-on-click-overlay":!0,"show-confirm-button":!0,"show-cancel-button":!0,"confirm-button-text":"Select Destination","cancel-button-text":"Select Origin","confirm-button-color":"#1CBC9B","cancel-button-color":"#1CBC9B",onConfirm:O,onCancel:N},{default:S(()=>[n("div",ie,[e[10]||(e[10]=n("img",{src:te,class:"w-16 h-16 mx-auto mb-4"},null,-1)),n("p",ue,K(p.value.title),1),n("div",re,[c(W,{icon:"info-o",type:"primary",size:"small",plain:"",color:"#1CBC9B",to:`/station/${p.value.slug}`},{default:S(()=>e[9]||(e[9]=[X("Station Information")])),_:1},8,["to"])])])]),_:1},8,["show"])],64)}}};export{ge as default};
